{% load static %}

<!DOCTYPE html>

<html>


    <head>

        <meta charset="utf-8"/>

        <meta name="viewport" content="width=device-width, initial-scale=1">


        <!-- CSS -->
        
        <link rel="stylesheet" href="https://bootswatch.com/5/flatly/bootstrap.min.css">

        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

        <link rel="stylesheet" href="{% static 'css/styles.css' %}">

        <link rel="stylesheet" href="{% static 'css/base.css' %}">


        <!-- JavaScript -->

        <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>



        <!-- JavaScript Bundle with Popper -->

        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-OERcA2EqjJCMA+/3y+gxIOqMEjwtxJY7qPCqsdltbNJuaOe923+mo//f6V8Qbsw3" crossorigin="anonymous"></script>


	  <!-- Bootstrap Max CDN --> 

	  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>

    </head>

    <title> Gamestore </title>

     <!-- Created the nav.html template and then included the code into base -->
    {% include 'store/nav.html' %}

    {% for message in messages %}

        {% if message.level == DEFAULT_MESSAGE_LEVELS.SUCCESS %}

            <h6 id="message-timer" class="alert alert-success text-center"> <i class="fa fa-sign-out" aria-hidden="true"></i> &nbsp; {{message}} </h6>


        {% endif %}

        
        {% if message.level == DEFAULT_MESSAGE_LEVELS.ERROR %}

            <h6 id="message-timer" class="alert alert-danger text-center"> <i class="fa fa-exclamation-triangle" aria-hidden="true"></i> &nbsp; {{message}} </h6>

        {% endif %}



        {% if message.level == DEFAULT_MESSAGE_LEVELS.INFO %}

            <h6 id="message-timer" class="alert alert-success text-center"> <i class="fa fa-check-circle" aria-hidden="true"></i> &nbsp; {{message}} </h6>

        {% endif %}


    {% endfor %}




    <body>


        {% block content %} 
        
        


            
        {% endblock %}
    
        


    </body>


    <script src="{% static 'js/app.js' %}"></script>

    <script>
        // Real-time search functionality
        $(document).ready(function() {
            let searchTimeout;
            
            $('#search-input').on('keyup', function() {
                clearTimeout(searchTimeout);
                
                const query = $(this).val();
                
                if (query.length >= 2) {
                    searchTimeout = setTimeout(function() {
                        performSearch(query);
                    }, 300); // Wait 300ms after user stops typing
                } else {
                    $('#search-suggestions').hide();
                }
            });

            // Hide suggestions when clicking outside
            $(document).on('click', function(e) {
                if (!$(e.target).closest('.search-container').length) {
                    $('#search-suggestions').hide();
                }
            });

            function performSearch(query) {
                $.ajax({
                    url: "{% url 'search-products' %}",
                    type: 'GET',
                    data: { 'q': query, 'ajax': '1' },
                    success: function(response) {
                        displaySuggestions(response);
                    },
                    error: function(xhr, errmsg, err) {
                        console.error('Search error:', err);
                    }
                });
            }

            function displaySuggestions(html) {
                $('#search-suggestions').html(html).show();
            }
        });
    </script>


</html>