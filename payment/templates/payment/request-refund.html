{% include "store/base.html" %}

{% load static %}

{% block content %}

<style>
    body {
        background-color: gray;
    }
    
    .refund-form-card {
        background-color: white;
        border-radius: 10px;
        padding: 30px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    
    .order-details {
        background-color: #f8f9fa;
        padding: 20px;
        border-radius: 8px;
        margin-bottom: 20px;
    }
    
    .product-item {
        border-left: 3px solid #007bff;
        padding-left: 15px;
        margin-bottom: 10px;
    }
</style>

<body>
    <br>

    <!-- Order Details -->
    <div class="container order-details shadow-md">
        <h4><i class="fa fa-shopping-bag" aria-hidden="true"></i> Order Details</h4>
        <hr>
        <p><strong>Order ID:</strong> #{{ order.id }}</p>
        <p><strong>Order Date:</strong> {{ order.date_ordered|date:"F d, Y" }}</p>
        <p><strong>Amount Paid:</strong> ${{ order.amount_paid|floatformat:2 }}</p>
        
        <h5 class="mt-3">Items in this order:</h5>
        {% for item in order_items %}
        <div class="product-item">
            <strong>{{ item.product.title }}</strong><br>
            Quantity: {{ item.quantity }} | Price: ${{ item.price|floatformat:2 }}<br>
            <small class="text-muted">Total: ${{ item.price|floatformat:2 }}</small>
        </div>
        {% endfor %}
    </div>

    <!-- Refund Request Form -->
    <div class="container refund-form-card shadow-md">
        <h3><i class="fa fa-undo" aria-hidden="true"></i> Request Refund</h3>
        <p>Please fill out this form to request a refund for your order.</p>
        <hr>

        <form method="POST">
            {% csrf_token %}

            <div class="form-group mb-3">
                <label for="reason"><strong>Reason for Refund <span class="text-danger">*</span></strong></label>
                <select class="form-control" id="reason" name="reason" required>
                    <option value="">-- Select a reason --</option>
                    <option value="DEFECTIVE">Product is defective</option>
                    <option value="WRONG_ITEM">Wrong item received</option>
                    <option value="NOT_AS_DESCRIBED">Not as described</option>
                    <option value="CHANGED_MIND">Changed my mind</option>
                    <option value="OTHER">Other reason</option>
                </select>
            </div>

            <div class="form-group mb-3">
                <label for="reason_details"><strong>Additional Details</strong></label>
                <textarea class="form-control" id="reason_details" name="reason_details" rows="4" placeholder="Please provide more details about your refund request..."></textarea>
                <small class="form-text text-muted">The more details you provide, the faster we can process your refund.</small>
            </div>

            <div class="form-group mb-3">
                <label for="tracking_number"><strong>Return Tracking Number (Optional)</strong></label>
                <input type="text" class="form-control" id="tracking_number" name="tracking_number" placeholder="e.g., 1Z999AA10123456784">
                <small class="form-text text-muted">If you've already shipped the item back, enter your tracking number here. You can also add it later.</small>
            </div>

            <hr>

            <div class="alert alert-info">
                <i class="fa fa-info-circle" aria-hidden="true"></i>
                <strong>Important:</strong>
                <ul class="mb-0 mt-2">
                    <li>You must ship the product back to us before the refund can be processed.</li>
                    <li>Your refund amount will be <strong>${{ order.amount_paid|floatformat:2 }}</strong></li>
                    <li>Refunds are processed via PayPal to the original payment method.</li>
                    <li>Please allow 3-5 business days after we receive the product for processing.</li>
                </ul>
            </div>

            <div class="d-flex justify-content-between align-items-center mt-4">
                <a href="{% url 'track-orders' %}" class="btn btn-secondary">
                    <i class="fa fa-arrow-left" aria-hidden="true"></i> Cancel
                </a>
                <button type="submit" class="btn btn-primary btn-lg">
                    <i class="fa fa-paper-plane" aria-hidden="true"></i> Submit Refund Request
                </button>
            </div>
        </form>
    </div>

    <br>
</body>

{% endblock %}